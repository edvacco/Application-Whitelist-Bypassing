using Contracts;
using System;
using System.Collections.Generic;
using System.Text;

namespace ExploitEngine.Vulnerabilities
{
    public class Exploiter
    {
        private List<AnalysisResult> _analysisResults;

        public Exploiter(List<AnalysisResult> analysisResults)
        {
            this._analysisResults = analysisResults;
        }

        public void ExploitAllThreats()
        {
            foreach (var analysis in _analysisResults)
                foreach (var threat in analysis.Threats)
                    Exploit(threat);
        }

        public void Exploit(Threat threat)
        {
            var exploiter = ThreatToExploitMatcher.Matcher[threat.Type];
            exploiter.Initialize(threat);
            exploiter.Exploit();
        }
    }
}
